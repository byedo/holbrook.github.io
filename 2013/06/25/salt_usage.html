<!DOCTYPE html>
<html>
  <head>
    <!-- meta information -->
<meta charset="utf-8">
<meta name="description" 
      content="[Salt的介绍](/2013/06/24/salt_intro.html)中提到了Salt支持变更操作、配置管理、状态监控所需的一些功能，如下图：![salt_functions](/images/2013/salt_usage/s..." >
<meta name="author" content="Holbrook(wanghaikuo@gmail.com)">

<!-- Enable responsiveness on mobile devices-->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

<!-- title -->
<title>salt的主要功能及使用 &middot; 心内求法</title>

<!-- icons -->
<link rel="shortcut icon" href="/public/images/favicon.png" />

<!-- stylesheets -->
<link rel="stylesheet" href="/public/css/syntax.css">
<link rel="stylesheet" href="/public/css/responsive.gs.12col.css">
<link rel="stylesheet" href="/public/css/animate.min.css">
<link rel="stylesheet" href="/public/css/main.css">

<!-- Google fonts -->
<link rel="stylesheet" href="/public/css/googleapis.css">


<!-- font Awesome -->
<link href="/public/css/font-awesome.css" rel="stylesheet">


<!-- feed links -->
<link rel="alternate" href="http://thinkinside.tk/feed.xml" type="application/rss+xml" title="">

  </head>
  <body>
    <div class="container">
      <header class="top row gutters">
        <div class="col span_2" id="logo-container">
          <a href="/" id="actual-logo" title="心内求法" style="background-image: url(/public/images/logo.png);"></a>
        </div>
        <nav class="col span_10">
	
  
  <a href="/index.html" title="首页"
     >首页</a>
  
  
  <a href="/pages/archive.html" title="归档"
     >归档</a>
  
  
  <a href="/pages/categories.html" title="分类"
     >分类</a>
  
  
  <a href="/pages/tags.html" title="标签"
     >标签</a>
  
  
  <a href="/feed.xml" title="订阅"
     >订阅</a>
  
  
  <a href="http://www.wumii.com/auto_app/download/nbn2Kljo" title="手机版"
     >手机版</a>
  
</nav>

      </header>

      <style>
.top_line {
  border-top: 1px solid #b3b3b3;
  border-top-width: 1px;
  border-top-style: solid;
  border-top-color: rgb(179, 179, 179);
}

.bottom_line {
  border-bottom: 1px solid #b3b3b3;
  border-bottom-width: 1px;
  border-bottom-style: solid;
  border-bottom-color: rgb(179, 179, 179);
}

</style>

<article class="single-post row gutters bottom_line">
  <div class="bottom_line">
  <h1 style="font-size: 2em;">salt的主要功能及使用</h1>
  <p>摘要：<br/>本文介绍Salt的主要功能和基本使用，包括minion节点的管理，批量操作，以及非常重要的配置管理。 掌握了这些内容，可以使用Salt极大提高运维的效率（事实上，Salt对于开发阶段也能提供很大的帮助，开发和运维的界限正在逐渐模糊）。</p>

  <time class="published" datetime="2013-06-25">2013-06-25
  
&sdot; 分类：
  
    <a href="/pages/categories.html#基础设施-ref">基础设施</a>
    <sup>4</sup>
    &nbsp;
  

  &sdot; 标签： 
  
    <a href="/pages/tags.html#devops-ref">devops</a>
    <sup>6</sup>
    &nbsp;
  
    <a href="/pages/tags.html#salt-ref">salt</a>
    <sup>4</sup>
    &nbsp;
  

  </time>
</div>

  

  <p><a href="/2013/06/24/salt_intro.html">Salt的介绍</a>中提到了Salt支持变更操作、配置管理、状态监控所需的一些功能，如下图：</p>

<p><img src="/images/2013/salt_usage/salt_functions.png" alt="salt_functions" /></p>

<p>本文详细介绍如何使用这些功能。</p>

<p>如果想对Salt的功能和使用有一个初步的了解，最好参考官方文档：<a href="http://salt.readthedocs.org/en/latest/topics/tutorials/walkthrough.html">Salt Stack Walkthrough</a>。</p>

<h1>批量操作(targeting)</h1>

<p>再回顾一下<a href="http://thinkinside.tk/2013/06/24/salt_intro.html#%E6%B5%8B%E8%AF%95-ref">前文中的例子</a>:</p>

<div class="highlight"><pre><code class="bash"> <span class="c"># 测试连通性</span>
 salt <span class="s1">&#39;*&#39;</span> test.ping

 <span class="c"># 查询主机运行了多长时间</span>
 sudo salt <span class="s1">&#39;*&#39;</span> cmd.run <span class="s2">&quot;uptime&quot;</span>


 <span class="c"># 批量重启服务</span>
 salt <span class="s1">&#39;*&#39;</span> cmd.run <span class="s2">&quot;service httpd restart&quot;</span>

 <span class="c"># 让多台机器一起，使用Apache Bench进行压力测试</span>
 salt <span class="s1">&#39;*&#39;</span> cmd.run <span class="s2">&quot;ab -n 10 -c 2 http://www.google.com/&quot;</span>
</code></pre></div>


<p>上面的例子都是对多个节点进行批量操作：使用通配符"'*'"对所有注册的节点进行操作。Salt支持多种方式对节点id(minion id)进行匹配。包括：</p>

<ul>
<li>默认：<a href="http://en.wikipedia.org/wiki/Glob_(programming">通配符(globbing)</a>)</li>
<li>E：<a href="http://zh.wikipedia.org/zh-hans/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F">正则表达式(Regular Expression)</a></li>
<li>L：列表</li>
<li>N: 分组(group)</li>
<li>C：复合匹配</li>
</ul>


<p>先看一下通配符、正则表达式和列表的例子：</p>

<div class="highlight"><pre><code class="bash"> <span class="c"># 通配符是最常用的匹配方式。Salt使用[linux风格的通配符](http://docs.python.org/2/library/fnmatch.html)</span>
 salt <span class="s1">&#39;*&#39;</span> test.ping
 salt <span class="s1">&#39;*.example.net&#39;</span> test.ping
 salt <span class="s1">&#39;*.example.*&#39;</span> test.ping
 salt <span class="s1">&#39;web?.example.net&#39;</span> test.ping
 salt <span class="s1">&#39;web[1-5]&#39;</span> test.ping
 salt <span class="s1">&#39;web-[x-z]&#39;</span> test.ping
 
 <span class="c"># 正则表达式可以适应更复杂的情况。使用[python的re模块](http://docs.python.org/2/library/re.html#module-re)进行匹配</span>
 salt -E <span class="s1">&#39;web1-(prod|devel)&#39;</span> test.ping
 
 <span class="c"># 最直接的方式是自己指定多个minion，即列表</span>
 salt -L <span class="s1">&#39;web1,web2,web3&#39;</span> test.ping
</code></pre></div>


<p><a href="http://docs.saltstack.com/topics/targeting/compound.html">复合匹配(Compound matchers)</a>有点复杂，后续会在其他文章中专门介绍。</p>

<p>分组匹配见本文的下一节。</p>

<h1>节点分组（nodegroups）</h1>

<p>好吧，批量操作确实很爽。但是每次都输入匹配规则有点麻烦，对于复杂的匹配规则更是如此。
salt的 <a href="(http://docs.saltstack.com/topics/targeting/nodegroups.html">nodegroups功能</a>可以将常用的匹配规则保存下来（称之为minion的分组）。批量操作是，只需要使用L标记指定要操作的group名字即可。
groups定义在master的配置文件<code>/etc/salt/master</code>中。</p>

<p>group 的定义可以使用各种匹配规则，比如：</p>

<div class="highlight"><pre><code class="bash">group1: <span class="s1">&#39;L@foo.domain.com, bar.domain.com,baz.domain.com or bl*.domain.com&#39;</span>
group2: <span class="s1">&#39;G@os:Debian and foo.domain.com&#39;</span>
</code></pre></div>


<p>同样的，使用复合匹配(Compound matchers)定义group的内容不在本文范围之内。</p>

<h1>命令编排（execution）</h1>

<p>Salt生来就有命令编排的功能。据说，Salt最先实现的是远程执行技术，然后才添加的配置管理功能。Salt使用ZeroMQ来处理命令执行的请求和响应消息，安装配置简单，并且性能非常高。</p>

<p>Salt即可以批量执行命令，也可以单机执行。通常单机执行用于测试：</p>

<ul>
<li>单机（立即）执行。 使用<a href="http://docs.saltstack.com/topics/tutorials/quickstart.html">salt-call</a>命令单机执行操作</li>
<li>批量(立即)执行。最常用的操作。使用salt命令，对匹配的minion节点执行操作</li>
</ul>


<p>Salt可以执行的命令也可以分为两种：</p>

<ul>
<li>系统命令，使用<code>cmd.run</code>执行</li>
<li>Salt模块，将常用的命令/批处理封装到内置的Salt模块(module)，使用<code>模块名.功能名</code>的方式执行。</li>
</ul>


<p>比如：</p>

<div class="highlight"><pre><code class="bash"> <span class="c"># 执行系统命令</span>
 salt <span class="s1">&#39;*&#39;</span> cmd.run <span class="s1">&#39;hostname&#39;</span>
 
 <span class="c"># 执行Salt模块</span>
 salt <span class="s1">&#39;*&#39;</span> disk.usage
</code></pre></div>


<p>使用Salt模块的好处是能够做到一致。比如同样是查看磁盘使用情况，<code>salt '*' cmd.run "df -h"</code>只能用于<em>NIX节点，而<code>salt '*' disk.usage</code>对</em>NIX和Windows都适用，并且采用相同结构返回数据，便于批量处理。</p>

<p>Salt已经内置了<a href="http://docs.saltstack.com/ref/modules/all/index.html">大量的模块</a>，这些模块涵盖了日常管理任务的主要任务，包括：</p>

<ul>
<li>通用的管理任务，比如apt, at, cp, cron, disk, extfs, file, grains, hosts, iptables, mount, network, pam, parted, pkg, ps, selinux, shadow, ssh, test等</li>
<li>针对特定软件的任务，比如apache, cassandra, djangomod, git, mongodb, mysql, nginx, nova, postgres, solr, sqlite3, 和tomcat</li>
</ul>


<p>而且，自己开发Salt模块也非常简单，很容易将实际管理操作中的一些经验通过自定义的模块固化下来，并方便分享。</p>

<p>在开发和调试模块的时候，可以使用<code>test=True</code>参数进行模拟执行(Dry run)。比如：</p>

<pre><code>salt 'minion1.example.com' state.highstate -v test=True
</code></pre>

<h1>节点信息(grains)</h1>

<p><a href="http://docs.saltstack.com/topics/targeting/grains.html">grains</a>是Salt内置的一个非常有用的模块。在用salt进行管理客户端的时候或者写state的时候都可以引用grains的变量。</p>

<p>grains的基本使用举例如下：</p>

<div class="highlight"><pre><code class="bash"> <span class="c"># 查看grains分类</span>
 salt <span class="s1">&#39;*&#39;</span> grains.ls  

 <span class="c"># 查看grains所有信息</span>
 salt <span class="s1">&#39;*&#39;</span> grains.items
 
 <span class="c"># 查看grains某个信息</span>
 salt <span class="s1">&#39;*&#39;</span> grains.item osrelease
</code></pre></div>


<h1>配置管理（state)</h1>

<p>配置管理是Salt中非常重要的内容之一。Salt通过内置的state模块支持配置管理所需的功能。关于这部分内容，官方文档有很详细的描述，可以参考
<a href="http://salt.readthedocs.org/en/latest/topics/tutorials/states_pt1.html">part 1</a>，
<a href="http://salt.readthedocs.org/en/latest/topics/tutorials/states_pt2.html">part 2</a>和
<a href="http://salt.readthedocs.org/en/latest/topics/tutorials/states_pt3.html">part 3</a>。</p>

<p>Salt中可以定义节点的目标状态，称之为state。state对应配置管理中的配置，可以对其进行标识、变更控制、变更识别、状态报告、跟踪和归档以及审计等一些的管理行为。</p>

<h2>状态描述</h2>

<p>Salt使用SLS文件（SaLt State file）描述状态。SLS使用<a href="http://yaml.org/spec/1.1/">YAML</a>格式进行数据序列化，因此简单明了，可读性也很高。</p>

<h3>基本描述(yaml)</h3>

<p>下边是一个简单的SLS文件例子:</p>

<div class="highlight"><pre><code class="yaml"> <span class="l-Scalar-Plain">apache</span><span class="p-Indicator">:</span>
   <span class="l-Scalar-Plain">pkg</span><span class="p-Indicator">:</span>
     <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">installed</span>
   <span class="l-Scalar-Plain">service</span><span class="p-Indicator">:</span>
     <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">running</span>
     <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">require</span><span class="p-Indicator">:</span>
       <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">pkg</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">apache</span>
</code></pre></div>


<p>该文件描述一个ID为<code>apache</code>的配置状态：</p>

<ul>
<li>软件包（pkg)已经安装</li>
<li>服务应该处于运行中</li>
<li>服务的运行依赖于<code>apache</code>软件包的安装</li>
</ul>


<p>state文件中的所有YAML变量名来自Salt的state模块。</p>

<p>Salt内置了大量的state模块，比如cron, cmd, file, group, host, mount, pkg, service, ssh_auth，user等。
详细清单参考<a href="http://docs.saltstack.com/ref/states/all/index.html">这里</a>。</p>

<p>还可以开发自己的state模块。</p>

<h3>扩展描述(jinja)</h3>

<p>state可以使用<a href="http://jinja.pocoo.org/">jinja</a>模板引擎进行扩展，其语法可以参考<a href="http://jinja.pocoo.org/docs/templates/">这里</a>。</p>

<p>下面是一个更复杂的例子：</p>

<div class="highlight"><pre><code class="html+jinja">vim:
  pkg:    
    { % if grains[&#39;os_family&#39;] == &#39;RedHat&#39; % } 
    - name: vim-enhanced    
    { % elif grains[&#39;os&#39;] == &#39;Debian&#39; % }
    - name: vim-nox    
    { % elif grains[&#39;os&#39;] == &#39;Ubuntu&#39; % }
    - name: vim-nox    
    { % endif % }
    - installed
    
</code></pre></div>


<p>该state增加了判断逻辑：如果是redhard系列的就安装 vim-enhanced，如果系统是Debian或者Ubuntu就安装vim-nox。</p>

<h3>逻辑关系</h3>

<p>state之间可以有<a href="http://docs.saltstack.com/ref/states/ordering.html">逻辑关系</a>。常见的关系举例如下：</p>

<ul>
<li>require：依赖某个state，在运行此state前，先运行依赖的state，依赖可以有多个</li>
</ul>


<div class="highlight"><pre><code class="yaml"> <span class="l-Scalar-Plain">httpd</span><span class="p-Indicator">:</span>
   <span class="l-Scalar-Plain">pkg</span><span class="p-Indicator">:</span>
     <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">installed</span>
   <span class="l-Scalar-Plain">file.managed</span><span class="p-Indicator">:</span>
     <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/etc/httpd/conf/httpd.conf</span>
     <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">source</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">salt://httpd/httpd.conf</span>
     <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">require</span><span class="p-Indicator">:</span>
       <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">pkg</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">httpd</span>
</code></pre></div>


<ul>
<li>watch：在某个state变化时运行此模块</li>
</ul>


<div class="highlight"><pre><code class="yaml"><span class="l-Scalar-Plain">redis</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">pkg</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">latest</span>
  <span class="l-Scalar-Plain">file.managed</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">source</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">salt://redis/redis.conf</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/etc/redis.conf</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">require</span><span class="p-Indicator">:</span>
      <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">pkg</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">redis</span>
    <span class="l-Scalar-Plain">service.running</span><span class="p-Indicator">:</span>
      <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">enable</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">True</span>
      <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">watch</span><span class="p-Indicator">:</span>
      <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">file</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/etc/redis.conf</span>
      <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">pkg</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">redis</span>
</code></pre></div>


<p>watch除具备require功能外，还增了关注状态的功能</p>

<ul>
<li>order：优先级比require和watch低，有order指定的state比没有order指定的优先级高</li>
</ul>


<div class="highlight"><pre><code class="yaml"><span class="l-Scalar-Plain">vim</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">pkg.installed</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">order</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">1</span>
</code></pre></div>


<p>想让某个state最后一个运行，可以用last</p>

<h2>保存状态</h2>

<p>状态描述文件(SLS)要保存在master节点中，并通过指令分发到minion节点。</p>

<ol>
<li>路径设置</li>
</ol>


<p>Salt master的配置文件(<code>/etc/salt/master</code>)中可以通过<code>file_roots</code>参数指定状态文件的保存路径。可以为不同的环境（如开发环境、UAT环境、生产环境、灾备环境等）分别指定路径，如下所示：</p>

<div class="highlight"><pre><code class="yaml"><span class="l-Scalar-Plain">file_roots</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">base</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">/srv/salt/</span>
  <span class="l-Scalar-Plain">dev</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">/srv/salt/dev/services</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">/srv/salt/dev/states</span>
  <span class="l-Scalar-Plain">prod</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">/srv/salt/prod/services</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">/srv/salt/prod/states</span>
</code></pre></div>


<p>其中,base环境是必须的。</p>

<ol>
<li>入口文件</li>
</ol>


<p><code>file_roots</code>中必须指定“base”环境的路径，因为该路径中存在Salt state的<a href="http://docs.saltstack.com/ref/states/highstate.html">入口文件: top.sls</a>。</p>

<p>Top文件建立配置环境、节点和状态配置之间的映射关系。比如一个简单的top.sls文件：</p>

<div class="highlight"><pre><code class="yaml"><span class="l-Scalar-Plain">base</span><span class="p-Indicator">:</span>
  <span class="s">&#39;*&#39;</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">servers</span>
<span class="l-Scalar-Plain">dev</span><span class="p-Indicator">:</span>
  <span class="s">&#39;*nodb*&#39;</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">mongodb</span>
</code></pre></div>


<p>该文件指定了：
- 所有节点使用base环境的servers配置
- <em>nodb</em>节点使用dev环境的mongodb配置</p>

<p>结合第一部分的file_roots配置，该top配置意味存在以下的配置文件：</p>

<ul>
<li>/srv/salt/servers.sls</li>
<li>/srv/salt/dev/mongodb.sls</li>
</ul>


<p>注：这里也可以使用文件夹<code>/srv/salt/servers/</code>和<code>/srv/salt/dev/mongodb/</code>，在文件夹中放置一组状态文件和配置文件，便于建立复杂的状态配置。</p>

<p>top.sls中的可配置内容非常丰富，具体内容可以参考<a href="http://docs.saltstack.com/ref/states/highstate.html">官方文档</a>。</p>

<h2>状态生效（State Enforcement）</h2>

<p>master上对状态进行定义，最终这些状态要传递到minion节点上。在本节的例子中，如果定义好了状态文件<code>/srv/salt/dev/mongodb.sls</code>：</p>

<div class="highlight"><pre><code class="yaml"><span class="l-Scalar-Plain">mongodb</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">pkg</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">installed</span>
</code></pre></div>


<p>可以使用命令<code>salt "minion1" state.highstate -v</code>使得所有针对"minion1"的state生效；</p>

<p>在执行状态之前先进行测试是个好主意，需要指定参数<code>test=True</code>。比如，<code>salt "minion1" state.highstate -v test=True</code>。</p>

<p>关于state模块的更多用法，可以参考<a href="https://salt.readthedocs.org/en/latest/ref/modules/all/salt.modules.state.html">state模块说明</a>，或<a href="http://docs.saltstack.com/ref/states/index.html#state-enforcement">官方文档</a>。</p>

<h2>更多</h2>

<p>Salt的state模块的功能不仅如此，还可以使用模板和变量，以及定义状态的定时自动生效。</p>

<h1>小结</h1>

<p>本文介绍Salt的主要功能和基本使用，包括minion节点的管理，批量操作，以及非常重要的配置管理。
掌握了这些内容，可以使用Salt极大提高运维的效率（事实上，Salt对于开发阶段也能提供很大的帮助，开发和运维的界限正在逐渐模糊）。</p>

<p>后续会介绍一些使用案例以及Salt的高级功能。</p>

  <!--百度分享 BEGIN-->
<div class="bdsharebuttonbox" class="top_line">
  <a href="#" class="bds_more" data-cmd="more">分享到：</a><a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博">新浪微博</a><a href="#" class="bds_qzone" data-cmd="qzone" title="分享到QQ空间">QQ空间</a><a href="#" class="bds_tqq" data-cmd="tqq" title="分享到腾讯微博">腾讯微博</a><a href="#" class="bds_renren" data-cmd="renren" title="分享到人人网">人人网</a><a href="#" class="bds_weixin" data-cmd="weixin" title="分享到微信">微信</a></div>

<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"2","bdSize":"16"},"share":{"bdSize":16},"image":{"viewList":["tsina","qzone","tqq","renren","weixin"],"viewText":"分享到：","viewSize":"16"},"selectShare":{"bdContainerClass":null,"bdSelectMiniList":["tsina","qzone","tqq","renren","weixin"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>
<!--百度分享 END-->

      <!--  评论  -->
      <div class="row-fluid">
        
          <!-- UY BEGIN -->
          <div id="uyan_frame"></div>
          <script type="text/javascript" id="UYScript" src="http://v1.uyan.cc/js/iframe.js?UYUserId=1784345" async="true"></script>
          <!-- UY END -->
        
      </div>
      <!--  评论  END -->





</article>

 <!--上一篇，下一篇-->
      <div class="row-fluid">
      
        <div class="span6">
          <a href="/2013/06/30/salt_sls_sample.html" rel="bookmark">&laquo;&nbsp;下一篇：Salt state实例解析</a>
        </div>
      

      
        <div class="span6">
        <a class="pull-right" href="/2013/06/24/salt_intro.html" rel="bookmark">上一篇：用salt管理成千上万的服务器&nbsp;&raquo;</a>
        </div>
      
      </div>
      <!--上一篇，下一篇 END-->


<!--wumii block-->
          <script type="text/javascript" id="wumiiRelatedItems"></script>


          <!--for wumii ， can be moved to footer-->
         <script type="text/javascript">
            var wumiiPermaLink = "http://thinkinside.tk/2013/06/25/salt_usage.html"; //请用代码生成文章永久的链接
            var wumiiTitle = "salt的主要功能及使用"; //请用代码生成文章标题
            var wumiiTags = "心内求法,devops,salt"; //请用代码生成文章标签，以英文逗号分隔，如："标签1,标签2"
            var wumiiCategories = ["基础设施"]; //请用代码生成文章分类，分类名放在 JSONArray 中，如: ["分类1", "分类2"]
            var wumiiSitePrefix = "http://www.thinkinside.tk/";
            var wumiiParams = "&num=5&mode=3&pf=JAVASCRIPT";
        </script>
        <script type="text/javascript" src="http://widget.wumii.cn/ext/relatedItemsWidget" async="true"></script>
        <a href="http://www.wumii.com/widget/relatedItems" style="border:0;">
            <img src="http://static.wumii.cn/images/pixel.png" alt="无觅相关文章插件，快速提升流量" style="border:0;padding:0;margin:0;" />
        </a>
        <!--end of wumii-->


    </div>
    
    <footer>
       <div class="row">
      <div class="col span_7">
        <p><h4 class="footer-title">心内求法</h4>
        制心一境，住心观性，澄心外照，摄心内证</p>
        
        <p>&copy; Copyright 2014  <a herf='mailto:wanghaikuo@gmail.com'>Holbrook Wong</a>. 
        <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" target="_blank">署名-非商业性使用-相同方式共享</a> 
        </p>
        

        <a rel="license nofollow" href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" target="_blank"><img alt="知识共享许可协议" style="border-width:0" src="/public/images/footer_cc.png" /></a>

        <a rel="nofollow" href="http://www.alexa.com/siteinfo/thinkinside.tk" target="_blank" class="AlexaSiteStatsWidget"></a>

        <!-- Site Meter -->
        <script type="text/javascript" src="http://s51.sitemeter.com/js/counter.js?site=s51thinkinside" async="true">
        </script>
        <noscript>
        <a href="http://s51.sitemeter.com/stats.asp?site=s51thinkinside" target="_top">
        <img src="http://s51.sitemeter.com/meter.asp?site=s51thinkinside" alt="Site Meter" border="0"/></a>
        </noscript>
      </div> <!-- /span8 -->

      <div class="col span_5">
          <h3>关于</h3>
          <iframe width="100%" height="75" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=75&fansRow=2&ptype=1&speed=0&skin=1&isTitle=0&noborder=0&isWeibo=0&isFans=0&uid=1878878250&verifier=b193b9de&dpc=1"></iframe>
          
          <h5>我以前的博客</h5>
          <a href="http://www.cnblogs.com/holbrook/" target="_blank">@博客园</a>(2012.2--2013.5)<br/>
          <a href="http://blog.csdn.net/thinkinside/" target="_blank">@CSDN</a>(2007.7--2012.2)<br/>
          <a href="http://www.blogjava.net/wanghaikuo" target="_blank">@blogjava</a>(2006.10--2007.7)
        </div>
      </div>
    </div>
 
    </footer>

    <!-- scripts -->
    <!--百度统计-->
    <script type="text/javascript">
    var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
    document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fb942c9f7549938d471dbef766d4b4792' type='text/javascript'%3E%3C/script%3E"));
    </script>
    
    <script src="/public/js/jquery-1.10.2.min.js"></script>
    <script src="/public/js/jquery.fitvids.min.js"></script>
    <script>
      $(document).ready(function(){
        $("article").fitVids();
      });
    </script>
  </body>
</html>
