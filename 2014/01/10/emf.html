<!DOCTYPE html>
<html>
  <head>
    <!-- meta information -->
<meta charset="utf-8">
<meta name="description" 
      content="# MDA的失败尽管早在2001年，OMG组织就提出了[MDA((Model Driven Architecture，模型驱动架构)](http://www.omg.org/mda/)，但是经过了火热的2005-2007年之后，MDA..." >
<meta name="author" content="Holbrook(wanghaikuo@gmail.com)">

<!-- Enable responsiveness on mobile devices-->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

<!-- title -->
<title>仰望MDA，拥抱EMF &middot; 心内求法</title>

<!-- icons -->
<link rel="shortcut icon" href="/public/images/favicon.png" />

<!-- stylesheets -->
<link rel="stylesheet" href="/public/css/syntax.css">
<link rel="stylesheet" href="/public/css/responsive.gs.12col.css">
<link rel="stylesheet" href="/public/css/animate.min.css">
<link rel="stylesheet" href="/public/css/main.css">

<!-- Google fonts -->
<link rel="stylesheet" href="/public/css/googleapis.css">


<!-- font Awesome -->
<link href="/public/css/font-awesome.css" rel="stylesheet">


<!-- feed links -->
<link rel="alternate" href="http://thinkinside.tk/feed.xml" type="application/rss+xml" title="">

  </head>
  <body>
    <div class="container">
      <header class="top row gutters">
        <div class="col span_2" id="logo-container">
          <a href="/" id="actual-logo" title="心内求法" style="background-image: url(/public/images/logo.png);"></a>
        </div>
        <nav class="col span_10">
	
  
  <a href="/index.html" title="首页"
     >首页</a>
  
  
  <a href="/pages/archive.html" title="归档"
     >归档</a>
  
  
  <a href="/pages/categories.html" title="分类"
     >分类</a>
  
  
  <a href="/pages/tags.html" title="标签"
     >标签</a>
  
  
  <a href="/feed.xml" title="订阅"
     >订阅</a>
  
  
  <a href="http://www.wumii.com/auto_app/download/nbn2Kljo" title="手机版"
     >手机版</a>
  
</nav>

      </header>

      <style>
.top_line {
  border-top: 1px solid #b3b3b3;
  border-top-width: 1px;
  border-top-style: solid;
  border-top-color: rgb(179, 179, 179);
}

.bottom_line {
  border-bottom: 1px solid #b3b3b3;
  border-bottom-width: 1px;
  border-bottom-style: solid;
  border-bottom-color: rgb(179, 179, 179);
}

</style>

<article class="single-post row gutters bottom_line">
  <div class="bottom_line">
  <h1 style="font-size: 2em;">仰望MDA，拥抱EMF</h1>
  <p>摘要：<br/>EMF与MOF的理想是类似的，只不过MOF在“仰望星空”，EMF更加“脚踏实地”。</p>

  <time class="published" datetime="2014-01-10">2014-01-10
  
&sdot; 分类：
  
    <a href="/pages/categories.html#软件开发-ref">软件开发</a>
    <sup>4</sup>
    &nbsp;
  

  &sdot; 标签： 
  
    <a href="/pages/tags.html#OSGi-ref">OSGi</a>
    <sup>4</sup>
    &nbsp;
  

  </time>
</div>

  

  <h1>MDA的失败</h1>

<p>尽管早在2001年，OMG组织就提出了<a href="http://www.omg.org/mda/">MDA((Model Driven Architecture，模型驱动架构)</a>，
但是经过了火热的2005-2007年之后，MDA的关注度持续下降。</p>

<p><img src="/images/e4/MDA_in_googletrends.png" alt="" /></p>

<p>长期以来，没有那个组织真正实现了MDA的工具或方案：Rational软件已经被IBM成功搞残；<a href="http://www.andromda.org/news.html">AndroMDA</a>的最后一次发布还是在2010年；<a href="http://www.eclipse.org/gmt/">Eclipse GMT</a>从2005年开始孵化，但到了2007年似乎已经死在了蛋中；将MDA的概念偷换为DSL的微软，也没有太多的建树；更有甚者，山寨出“KCOM商业工程”的凯科思特居然<a href="http://www.110.com/panli/panli_122041.html">为5万元的项目惹上官司</a>，后来更是销声匿迹。</p>

<p>怪只怪OMG的胃口太大，希望为各种语言、各种技术平台建立一个“大一统建模标准”：</p>

<p><img src="http://www.omg.org/mda/mda_audio/mda_rollovers/mda_left_new2.gif" alt="" /></p>

<p>结果忙坏了厂商，兴奋了开发商，苦了用户和程序员。最终一场闹剧黯然收场，消失个干干静静。</p>

<p>其实抛开MDA的各种理想化的标准(如MOF、CWM等)，MDA提出了“从模型到模型”的软件开发周期：</p>

<p><img src="/images/e4/MDA_lifecycle.jpg" alt="" /></p>

<p>如果不是OMG太霸气，太死心眼，“强调MDA必须基于OMG的各项标准”，上述的路线图不失为一种好的思路。</p>

<p>比如，如果不过多强调PIM与PSM的差异和PSM的自动生成代码能力，而是使用一种在分析和设计阶段都可以使用的“领域模型”，就成立至今仍被广泛认可的DDD（领域驱动设计）方法。</p>

<h1>EMF vs MOF</h1>

<p>MDA为了支撑其“大一统建模标准”，提出了四层模型：</p>

<p><img src="/images/e4/MDA_4_layers.png" alt="" /></p>

<ul>
<li>M0: 实例层，表现为代码。是M1的实例化</li>
<li>M1: 模型层，比如，用UML设计的一个模型</li>
<li>M2: 元模型层，包括建模语言的元模型，如UML元模型等</li>
<li>M3: 元元模型层， OMG定义了一个"MOF"，目标是作为所有建模语言的元模型</li>
</ul>


<p>MOF(MetaObject Facility，元对象机制)的目标是描述天下所有的模型，包括MOF自身。这让我想起了“元图灵机”——能够输出天下所有的图灵机，甚至包括自身的超级图灵机。</p>

<p>EMF与MOF的理想是类似的，只不过MOF在“仰望星空”，EMF更加“脚踏实地”。EMF的目标如下：</p>

<p><img src="/images/e4/EMF_%20purpose.png" alt="" /></p>

<p>在开发过程中，一个“古板”的程序员可能会进行如下工作：</p>

<ul>
<li>用UML设计模型</li>
<li>基于某种schema，用XML保存模型</li>
<li>实现模型的接口定义</li>
<li>编写模型的实现</li>
</ul>


<p>这些工作中，UML、XML、代码（接口和实现）中都体现了模型的设计。或者说，信息是冗余的。对于冗余的信息，保持一致性是很麻烦的，
所以我们经常发现代码和设计文档/模型是不同步的。极端的程序员提出“代码是唯一的设计文档”的观点；而中庸的程序员设计了EMF。</p>

<p>Eclipse Modeling Framework是Eclipse提供的一套建模框架。可以直接编写EMF模型，也可以从UML、XML、Java(annotations)生成模型；反过来，EMF模型也可以转换生成UML、XML和Java代码。在EMF看来，"To model or to program, that is not the question."</p>

<h1>EMF元模型</h1>

<p>EMF自身也是一个模型，当然也有其定义（元模型）。描述EMF的模型是Ecore元模型。Ecore模型已经可以描述自身，所以可以说Ecore兼具了MDA中的M3、M2层的功能。</p>

<p>一个简化的Ecore模型如下图所示：</p>

<p><img src="/images/e4/Ecore.png" alt="" /></p>

<ul>
<li>EClass    用于类</li>
<li>EAttribute 用于属性</li>
<li>EReference 用于类之间的关联</li>
<li>EDataType 用于值对象</li>
</ul>


<h1>EMF格式定义和编辑工具</h1>

<p>EMF的模型保持XMI格式的文件。</p>

<p>XMI(XML-based Metadata Interchange，基于XML的元数据交互)，是OMG基于XML、UML和MOF定义的一种元数据描述语言。微软也搞过一个与其类似的”开放信息模型”。</p>

<p>尽管可以从UML、XML、Java(annotations)等模型生成EMF模型，但更经常使用的方式是直接定义EMF模型。</p>

<p>Eclipse Modeling Project中，提供了模型编辑器：</p>

<p><img src="/images/e4/EMF_editor.png" alt="" /></p>

<p>也有一些厂商提供了基于UML方式编辑EMF模型的工具。比如<a href="">Omondo EclipseUML</a>，但是目前只支持到Eclipse 3.7。</p>

<h1>从EMF模型生成代码</h1>

<p>如上所述，EMF模型可以生成UML、XML甚至RDB Schema，但是最常用的功能还是生成Java代码。</p>

<p>Eclipse Modeling Framework可以定义和编辑EMF Generator Model(.genmodel)，该模型定义了从一个EMF模型(ecore)生成代码的各种行为。可以生成的代码包括：</p>

<ul>
<li>Model Code: 模型代码，包括接口和实现</li>
<li>Edit Code: 对模型的"DAO"代码</li>
<li>Editor Code: 基于Eclipse Plugin的模型编辑界面，依赖 Edit Code</li>
<li>Test Code: 模型测试代码</li>
</ul>


<p>如果不是开发Eclipse Plugin，可能更关注的是模型代码。
尽管一开始的时候对EMF生成的模型代码会不习惯，觉得不像自定义POJO那样简洁，
但是EMF生成的模型代码比自己编写的要健壮：</p>

<ul>
<li>接口和实现相分离。自己开发的模型，尤其是领域模型，可能不会这样实现</li>
<li>模型通用接口。EMF生成的模型，每个接口是继承自<code>EObject</code>，该接口实现了一些通用的模型交换API</li>
<li>事件通知。对于模型的变化，EMF统一提供了监听机制</li>
</ul>


  <!--百度分享 BEGIN-->
<div class="bdsharebuttonbox" class="top_line">
  <a href="#" class="bds_more" data-cmd="more">分享到：</a><a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博">新浪微博</a><a href="#" class="bds_qzone" data-cmd="qzone" title="分享到QQ空间">QQ空间</a><a href="#" class="bds_tqq" data-cmd="tqq" title="分享到腾讯微博">腾讯微博</a><a href="#" class="bds_renren" data-cmd="renren" title="分享到人人网">人人网</a><a href="#" class="bds_weixin" data-cmd="weixin" title="分享到微信">微信</a></div>

<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"2","bdSize":"16"},"share":{"bdSize":16},"image":{"viewList":["tsina","qzone","tqq","renren","weixin"],"viewText":"分享到：","viewSize":"16"},"selectShare":{"bdContainerClass":null,"bdSelectMiniList":["tsina","qzone","tqq","renren","weixin"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>
<!--百度分享 END-->

      <!--  评论  -->
      <div class="row-fluid">
        
          <!-- UY BEGIN -->
          <div id="uyan_frame"></div>
          <script type="text/javascript" id="UYScript" src="http://v1.uyan.cc/js/iframe.js?UYUserId=1784345" async="true"></script>
          <!-- UY END -->
        
      </div>
      <!--  评论  END -->





</article>

 <!--上一篇，下一篇-->
      <div class="row-fluid">
      
        <div class="span6">
          <a href="/2014/01/12/dependency_injection_in_e4.html" rel="bookmark">&laquo;&nbsp;下一篇：Eclipse e4：从OSGi-DS到依赖注入</a>
        </div>
      

      
        <div class="span6">
        <a class="pull-right" href="/2014/01/08/build_osgi_bundle_with_tycho_maven_plugin.html" rel="bookmark">上一篇：Tycho：用Maven构建Eclipse Plugin项目&nbsp;&raquo;</a>
        </div>
      
      </div>
      <!--上一篇，下一篇 END-->


<!--wumii block-->
          <script type="text/javascript" id="wumiiRelatedItems"></script>


          <!--for wumii ， can be moved to footer-->
         <script type="text/javascript">
            var wumiiPermaLink = "http://thinkinside.tk/2014/01/10/emf.html"; //请用代码生成文章永久的链接
            var wumiiTitle = "仰望MDA，拥抱EMF"; //请用代码生成文章标题
            var wumiiTags = "心内求法,OSGi"; //请用代码生成文章标签，以英文逗号分隔，如："标签1,标签2"
            var wumiiCategories = ["软件开发"]; //请用代码生成文章分类，分类名放在 JSONArray 中，如: ["分类1", "分类2"]
            var wumiiSitePrefix = "http://www.thinkinside.tk/";
            var wumiiParams = "&num=5&mode=3&pf=JAVASCRIPT";
        </script>
        <script type="text/javascript" src="http://widget.wumii.cn/ext/relatedItemsWidget" async="true"></script>
        <a href="http://www.wumii.com/widget/relatedItems" style="border:0;">
            <img src="http://static.wumii.cn/images/pixel.png" alt="无觅相关文章插件，快速提升流量" style="border:0;padding:0;margin:0;" />
        </a>
        <!--end of wumii-->


    </div>
    
    <footer>
       <div class="row">
      <div class="col span_7">
        <p><h4 class="footer-title">心内求法</h4>
        制心一境，住心观性，澄心外照，摄心内证</p>
        
        <p>&copy; Copyright 2014  <a herf='mailto:wanghaikuo@gmail.com'>Holbrook Wong</a>. 
        <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" target="_blank">署名-非商业性使用-相同方式共享</a> 
        </p>
        

        <a rel="license nofollow" href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" target="_blank"><img alt="知识共享许可协议" style="border-width:0" src="/public/images/footer_cc.png" /></a>

        <a rel="nofollow" href="http://www.alexa.com/siteinfo/thinkinside.tk" target="_blank" class="AlexaSiteStatsWidget"></a>

        <!-- Site Meter -->
        <script type="text/javascript" src="http://s51.sitemeter.com/js/counter.js?site=s51thinkinside" async="true">
        </script>
        <noscript>
        <a href="http://s51.sitemeter.com/stats.asp?site=s51thinkinside" target="_top">
        <img src="http://s51.sitemeter.com/meter.asp?site=s51thinkinside" alt="Site Meter" border="0"/></a>
        </noscript>
      </div> <!-- /span8 -->

      <div class="col span_5">
          <h3>关于</h3>
          <iframe width="100%" height="75" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=75&fansRow=2&ptype=1&speed=0&skin=1&isTitle=0&noborder=0&isWeibo=0&isFans=0&uid=1878878250&verifier=b193b9de&dpc=1"></iframe>
          
          <h5>我以前的博客</h5>
          <a href="http://www.cnblogs.com/holbrook/" target="_blank">@博客园</a>(2012.2--2013.5)<br/>
          <a href="http://blog.csdn.net/thinkinside/" target="_blank">@CSDN</a>(2007.7--2012.2)<br/>
          <a href="http://www.blogjava.net/wanghaikuo" target="_blank">@blogjava</a>(2006.10--2007.7)
        </div>
      </div>
    </div>
 
    </footer>

    <!-- scripts -->
    <!--百度统计-->
    <script type="text/javascript">
    var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
    document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fb942c9f7549938d471dbef766d4b4792' type='text/javascript'%3E%3C/script%3E"));
    </script>
    
    <script src="/public/js/jquery-1.10.2.min.js"></script>
    <script src="/public/js/jquery.fitvids.min.js"></script>
    <script>
      $(document).ready(function(){
        $("article").fitVids();
      });
    </script>
  </body>
</html>
