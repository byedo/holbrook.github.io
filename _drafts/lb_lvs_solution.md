---
layout: post
title: "LVS负载均衡方案"
description: ""
category: 解决方案
tags: [负载均衡]
---

服务器集群和负载均衡的方式目前主要有DNS轮询、CDN（内容分发网络）和IP负载均衡。
其中DNS的方式简单经济，但是可靠性很差；CDN方式无论是自建还是使用第三方的平台都比较昂贵；IP负载均衡技术具有较好的均衡性。

从实现方式上，IP负载均衡可以分为硬件负载均衡（如F5）和软件负载均衡（如LVS、NginX、HAProxy)。

信息技术中心之前实施了基于NginX的负载均衡方案，使用NginX反向代理多个应用服务器，实现应用服务器的负载均衡，
并通过NginX对域名和虚拟目录进行统一的管理。
经过半年多的使用，该方案收到了良好的效果，目前已经应用到外网、办公网和内网的多个应用系统。

如果从公司的总体基础设施架构上来看，该方案还有一些问题没有解决：

1. 性能问题。nginx使用主备的方式实现HA，没有配置集群。在目前的虚拟机环境下每秒处理请求约2.4万，最大并发用户数为700左右。这样的负载能力对于内部应用系统完全够用，但是对于互联网应用就有所不足了。
2. 不具备跨域负载均衡的能力
   无法在总部和灾备中心之间进行负载调度。机房和灾备中心不能同时提供服务
3. 

目前公司使用F5来解决网站等高并发系统的负载均衡，对于个别的应用系统，已经实现了 F5 --> NginX --> AppServer 的访问通道。
但是F5本身价格较高，在扩展的弹性方面有所不足。解决了1，没有解决2，3，。。。

本方案探讨如何使用LVS代替F5，实现高性能的Web服务器负载均衡。
考虑缓存服务器、双活的灾备中心，DDOS防御、xxxxxxx的实现机制。
作为扩展部分，提及用LVS实现数据库负载均衡(mysql)，邮件服务器负载均衡，xxx，以备后续的架构规划过程中的参考。

---
4. 文件同步，共享存储，内容分发，自动部署等
5. 可管理性
---


# 技术方案
总体来说，要打造一个可伸缩的网络服务架构。具体需求包括：

可伸缩网络服务：通过横向或纵向扩展，很容易提高网络服务的处理能力
负载均衡：
高可用(HA):
高性价比：如果进行横向扩展的代价很大，也不能称为可伸缩
可维护：
	文件同步，共享存储，内容分发，自动部署等



## AS-IS

## TO-BE
LVS:负载均衡
Nginx：web服务，基于内容的请求调度（通过 路径 划分 应用系统）
# 实施计划

1. 先外网，后内网
2. 先总部，后新疆
3. 逐步增加cache 服务器等

# 后续方案

1. LVS-mysql
2. LVS-mail
3. 